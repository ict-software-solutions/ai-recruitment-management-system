<div id="profile" class="page-layout carded fullwidth inner-scroll">
  <div class="ex-1">
    <div class="center">
      <div class="content-card" style="height: 750px !important;">
        <div class="mb-24" fxLayout="column" fxLayoutAlign="start" fxLayout.gt-md="row">
          <form class="mat-card mat-elevation-z4 p-24 mr-0" fxLayout="column" fxLayoutAlign="start" fxFlex="1 0 auto"
            name="form" [formGroup]="userForm" style="height: auto;">
            <header class="profile_header" color="accent">
              <div class="title">
                <div id="photos">
                  <img class="profile-image avatar" src="assets/images/avatars/generic.jpg"
                    style="margin: -7px 8px -10px -7px;" />
                </div>
                <div class="camera_button">
                  <button mat-mini-fab color="basic" aria-label="Example icon button with a filter list icon">
                    <mat-icon color="accent">local_see</mat-icon>
                  </button>
                </div>
                <div class="image_upload">
                  <input id="file-upload" type="file" (input)="uploadFile($event)" />
                </div>

                <div class="info">
                  <h1 *ngIf="showForMyProfile === false && userId != 0">
                    Edit Info
                  </h1>
                  <h1 *ngIf="showForAddEditUser === false && userId === 0">Add User</h1>
                  <h1 *ngIf="showForMyProfile === true">My Profile</h1>
                </div>

                <div class="buttons">
                  <button mat-icon-button color="light" class="edit_button" (click)="Edit()" *ngIf="!enableEdit"style="margin-right:15px;">
                    <mat-icon style="line-height: 13px;">edit</mat-icon>Edit
                  </button>

                  <button mat-raised-button color="light" *ngIf="showForMyProfile && enableEdit == true"
                    class="submit-button-save" (click)="updateProfile(userForm.value)">
                    Save
                  </button>
                  <button mat-raised-button color="light" class="submit-button-add"
                    *ngIf="showForAddEditUser === false && userId === 0" (click)="updateProfile(userForm.value)">
                    Add
                  </button>
                  <button mat-raised-button color="light" class="submit-button-update"
                    *ngIf="showForMyProfile === false && userId != 0" (click)="updateProfile(userForm.value)">
                    Update
                  </button>
                  <button mat-raised-button color="light" (click)="Edit()"
                    *ngIf="enableEdit && showForMyProfile === false" class="submit-button-cancel"
                    (click)="canceledit()">
                    Cancel
                  </button>
                  <button mat-raised-button color="light" (click)="edit()"
                    *ngIf="enableEdit && showForMyProfile === true" class="submit-button-cancel" (click)="canceledit()">
                    Cancel
                  </button>
                </div>
              </div>
            </header>

            <div fxLayout="row" fxLayout.xs="column" fxLayoutWrap fxLayoutGap="0.5%" fxLayoutAlign="start center"
              style="margin-top: 27px;">
              <mat-form-field appearance="outline" fxFlex="33%">
                <mat-label>First Name</mat-label>
                <input matInput type="text" formControlName="firstName" type="text" [readonly]="viewMode" />
                <mat-icon matSuffix class="secondary-text">account_circle</mat-icon>
                <!-- <mat-error *ngIf="form.get('firstName').hasError('required')"> Firstname is required</mat-error> -->
              </mat-form-field>
              <mat-form-field appearance="outline" fxFlex="34%">
                <mat-label>Second Name</mat-label>
                <input matInput type="text" formControlName="middleName" type="text" [readonly]="viewMode" />
                <mat-icon matSuffix class="secondary-text">account_circle</mat-icon>
                <!-- <mat-error>First Name is required!</mat-error> -->
              </mat-form-field>
              <mat-form-field appearance="outline" fxFlex="33%">
                <mat-label>Last name</mat-label>
                <input matInput type="text" formControlName="lastName" [readonly]="viewMode" />
                <mat-icon matSuffix class="secondary-text">account_circle</mat-icon>
                <!-- <mat-error *ngIf="form.get('lastName').hasError('required')"> Lastname is required</mat-error> -->
              </mat-form-field>
            </div>
            <div fxLayout="row" fxLayout.xs="column" fxLayoutWrap fxLayoutGap="0.5%" fxLayoutAlign="start center"
              style="margin-top: 12px;" *ngIf="flagForScreen == 'myProfile' || flagForScreen == 'editUser'">
              <mat-form-field appearance="outline" fxFlex="33%" style="width: 232px;">
                <mat-label>User Name</mat-label>
                <input matInput type="text" formControlName="userName" type="text" pattern="[a-zA-Z][a-zA-Z0-9_.-]*"
                  [readonly]="viewMode" />
                <mat-icon matSuffix class="secondary-text">account_circle</mat-icon>
                <!-- <mat-error *ngIf="form.get('userName').hasError('required')">Username is required</mat-error> -->
                <mat-error *ngIf="userForm.get('userName').hasError('minlength')">User name must be at least 6 charecters
                </mat-error>
                <mat-error *ngIf="userForm.get('userName').hasError('pattern') && userForm.get('userName').value.length > 5">
                  Please enter valid user name use(a-z,A-Z,0-9, _ . -)</mat-error>
              </mat-form-field>
              <mat-form-field appearance="outline" fxFlex="34%">
                <mat-label>Email
                  <span style="color: green;" *ngIf="userDetails?.activated === true">
                    <mat-icon>check_circle</mat-icon>
                  </span>
                 <span style="color: red;" *ngIf="userDetails?.activated === false">
                    <mat-icon>error_outline</mat-icon>
                  </span>
                </mat-label>
                <input matInput type="email" formControlName="emailAddress" [readonly]="viewMode"
                  (blur)="emailChange(flagForScreen, userForm.controls.emailAddress.value)" />
                <mat-icon matSuffix class="secondary-text">mail</mat-icon>
                <!-- <mat-error *ngIf="form.get('emailAddress').hasError('required')"> Email id is required</mat-error> -->
                <mat-error
                  *ngIf="!userForm.get('emailAddress').hasError('required') && userForm.get('emailAddress').hasError('pattern')">
                  Please enter a valid email address
                </mat-error>
              </mat-form-field>

              <mat-form-field appearance="outline" fxFlex="33%">
                <mat-label>Mobile
                  <!-- <span style="color: red;">
                    <mat-icon>error_outline</mat-icon>
                  </span> -->
                </mat-label>
                <input matInput type="tel" formControlName="mobileNumber" [readonly]="viewMode" />
                <mat-icon matSuffix class="secondary-text">call</mat-icon>
                <!-- <mat-error>Mobile is required!</mat-error> -->
                <mat-error
                  *ngIf="!userForm.get('mobileNumber').hasError('required') && userForm.get('mobileNumber').hasError('pattern')">
                  Please enter a valid Mobile Number
                </mat-error>
              </mat-form-field>
            </div>

            <div fxLayout="row" fxLayout.xs="column" fxLayoutWrap fxLayoutGap="0.5%" fxLayoutAlign="start center"
              style="margin-top: 12px;" *ngIf="flagForScreen == 'addUser'">
              <mat-form-field appearance="outline" fxFlex="50%">
                <mat-label>Email
                  <!-- <span style="color: green;">
                    <mat-icon>check_circle</mat-icon>
                  </span> -->
                </mat-label>
                <input matInput type="email" formControlName="emailAddress" [readonly]="viewMode" />
                <mat-icon matSuffix class="secondary-text">mail</mat-icon>
                <!-- <mat-error *ngIf="form.get('emailAddress').hasError('required')"> Email id is required</mat-error> -->
                <mat-error
                  *ngIf="!userForm.get('emailAddress').hasError('required') && userForm.get('emailAddress').hasError('pattern')">
                  Please enter a valid email address
                </mat-error>
              </mat-form-field>

              <mat-form-field appearance="outline" fxFlex="50%">
                <mat-label>Mobile
                  <!-- <span style="color: red;">
                    <mat-icon>error_outline</mat-icon>
                  </span> -->
                </mat-label>
                <input matInput type="tel" formControlName="mobileNumber" [readonly]="viewMode" />
                <mat-icon matSuffix class="secondary-text">call</mat-icon>
                <!-- <mat-error>Mobile is required!</mat-error> -->
                <mat-error
                  *ngIf="!userForm.get('mobileNumber').hasError('required') && userForm.get('mobileNumber').hasError('pattern')">
                  Please enter a valid Mobile Number
                </mat-error>
              </mat-form-field>
            </div>

            <div fxLayout="row" fxLayoutAlign="start center" fxLayout.xs="column" fxLayoutWrap fxLayoutGap="0.5%"
              style="margin-top: 12px;" *ngIf="showForMyProfile === true">
              <mat-form-field appearance="outline" fxFlex="50%">
                <mat-label>Company Name</mat-label>
                <input matInput type="text" formControlName="companyname" [readonly]="viewMode" />
                <mat-icon matSuffix class="secondary-text">location_city</mat-icon>
              </mat-form-field>
              <mat-form-field appearance="outline" fxFlex="50%">
                <mat-label>Position</mat-label>
                <input matInput type="text" formControlName="position" [readonly]="viewMode" />
                <mat-icon matSuffix class="secondary-text">work_outline</mat-icon>
              </mat-form-field>
            </div>

            <div fxLayout="row" fxLayoutAlign="start center" fxLayout.xs="column" fxLayoutWrap fxLayoutGap="0.5%"
              style="margin-top: 12px;" *ngIf="showForMyProfile === true">
              <mat-form-field appearance="outline" fxFlex="100%" style="width: 232px;">
                <mat-label>Address</mat-label>
                <textarea matInput formControlName="address" max-rows="7" [readonly]="viewMode"> </textarea>
              </mat-form-field>
            </div>

            <div fxLayout="row" class="next_row" fxLayoutAlign="start center" fxLayout.xs="column" fxLayoutWrap
              fxLayoutGap="0.5%" *ngIf="showForMyProfile === true">
              <mat-form-field appearance="outline" fxFlex="23%">
                <mat-label>Postal Code</mat-label>
                <input matInput type="tel" #postalcode value="94043" formControlName="postalcode" maxlength="5"
                  [readonly]="viewMode" />
                <mat-icon matSuffix class="secondary-text">markunread_mailbox</mat-icon>
              </mat-form-field>
              <mat-form-field appearance="outline" fxFlex="25%">
                <mat-label>City</mat-label>
                <input matInput type="text" formControlName="city" [readonly]="viewMode" />
                <mat-icon matSuffix class="secondary-text">location_city</mat-icon>
              </mat-form-field>

              <mat-form-field appearance="outline" fxFlex="23%">
                <mat-label>State</mat-label>
                <input matInput type="text" formControlName="state" [readonly]="viewMode" />
                <mat-icon matSuffix class="secondary-text">location_city</mat-icon>
              </mat-form-field>
              <mat-form-field appearance="outline" fxFlex="25%">
                <mat-label>Country</mat-label>
                <input matInput type="text" formControlName="country" [readonly]="viewMode" />
                <mat-icon matSuffix class="secondary-text">flag</mat-icon>
              </mat-form-field>
            </div>

            <div fxLayout="row" fxLayoutAlign="start center" fxLayout.xs="column" fxLayoutWrap fxLayoutGap="0.5%"
              style="margin-top: 12px;" *ngIf="showForMyProfile === false">
              <!-- <mat-form-field fxFlex="30"  appearance="outline"> -->
              <mat-form-field appearance="outline" fxFlex="33%" style="width: 232px;">
                <mat-label>User Type</mat-label>
                <mat-select [disabled]="viewMode" formControlName="userType">
                  <mat-option *ngFor="let usertype of usertypes" [value]="usertype">
                    {{ usertype }}
                  </mat-option>
                </mat-select>
              </mat-form-field>
              <!-- <mat-form-field fxFlex="30"  appearance="outline"> -->
              <mat-form-field appearance="outline" fxFlex="34%" style="width: 232px;">
                <mat-label>User Role</mat-label>
                <mat-select [disabled]="viewMode" formControlName="roleId">
                  <mat-option *ngFor="let roleList of roleLists" [value]="roleList.roleId">
                    {{ roleList.roleName }}
                  </mat-option>
                </mat-select>
              </mat-form-field>

              <mat-form-field appearance="outline" fxFlex="82%" *ngIf="showForMyProfile === false && userId != 0"
                style="width: 232px;">
                <mat-label>Valid From</mat-label>
                <input matInput [matDatepicker]="picker1" name="validFrom" formControlName="validFrom"
                  [readonly]="viewMode" />
                <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                <mat-datepicker #picker1></mat-datepicker>
              </mat-form-field>

              <mat-form-field appearance="outline" fxFlex="82%" *ngIf="showForAddEditUser === false && userId === 0"
                style="width: 232px;">
                <mat-label>User Name</mat-label>
                <input matInput formControlName="userName" pattern="[a-zA-Z][a-zA-Z0-9_.-]*" required />
                <mat-icon matSuffix class="secondary-text">account_circle</mat-icon>
                <!-- <mat-error *ngIf="form.get('userName').hasError('required')"> User name is required
                </mat-error> -->
                <mat-error *ngIf="userForm.get('userName').hasError('minlength')">User name must be at least 6 charecters
                </mat-error>
                <mat-error *ngIf="userForm.get('userName').hasError('pattern') && userForm.get('userName').value.length > 5">
                  Please enter valid user name use(a-z,A-Z,0-9,_/-)</mat-error>
              </mat-form-field>
            </div>

            <!-- <div fxLayout="row" fxLayoutAlign="space-between"> -->
            <div fxLayout="row" fxLayoutAlign="start center" fxLayout.xs="column" fxLayoutWrap fxLayoutGap="0.5%"
              style="margin-top: 12px;" *ngIf="showForMyProfile === false && userId != 0">
              <mat-form-field appearance="outline" fxFlex="33%" style="width: 232px;">
                <mat-label>Password Since</mat-label>
                <input matInput [matDatepicker]="picker2" name="passwordSince" formControlName="passwordSince"
                  [readonly]="viewMode" />
                <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                <mat-datepicker #picker2></mat-datepicker>
              </mat-form-field>

              <mat-form-field appearance="outline" fxFlex="34%" style="width: 232px;">
                <mat-label>Password Expiry Date</mat-label>
                <input matInput [matDatepicker]="picker3" name="passwordExpiryDate" formControlName="passwordExpiry"
                  [readonly]="viewMode" />
                <mat-datepicker-toggle matSuffix [for]="picker3"></mat-datepicker-toggle>
                <mat-datepicker #picker3></mat-datepicker>
              </mat-form-field>

              <mat-form-field appearance="outline" fxFlex="33%" style="width: 232px;">
                <mat-label>Valid To</mat-label>
                <input matInput [matDatepicker]="picker4" name="validTo" formControlName="validTo"
                  [readonly]="viewMode" />
                <mat-datepicker-toggle matSuffix [for]="picker4"></mat-datepicker-toggle>
                <mat-datepicker #picker4></mat-datepicker>
              </mat-form-field>
            </div>

            <div fxLayout="row" fxLayoutAlign="start center" fxLayout.xs="column" fxLayoutWrap fxLayoutGap="0.5%"
              style="margin-top: 12px;" >
              <div fxFlex="33%" appearance="outline" *ngIf="userDetails?.locked === true">
                <section class="tp-section">
                  <label class="example-margin">Account Status:</label>&nbsp;
                  <input type="radio" value="activated" [checked]="false"  name="status" /> Activated &nbsp;
                  <input type="radio" value="locked" [checked]="true" name="status" /> Locked
                </section>
              </div>
              <div fxFlex="34%" class="px-8" appearance="outline" *ngIf="flagForScreen === 'editUser'">
                <mat-checkbox (change)="changePassword($event.checked)" (click)="onValueChange()"
                  formControlName="check">Change Password</mat-checkbox>
              </div>

              <mat-form-field appearance="outline" fxFlex="33%"
                *ngIf="showPasswordsection && enableEdit && showForMyProfile === false && userId != 0">
                <mat-label>New Password</mat-label>
                <input matInput type="Password" [type]="hide1 ? 'password' : 'text'" formControlName="newPassword"
                  pattern="((?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$%^&*?/]).{8,15})" (change)="setPassword(form.value)"
                  required />
                <mat-icon matSuffix class="secondary-text1" (click)="hide1 = !hide">
                  {{ hide1 ? "visibility_off" : "visibility" }}</mat-icon>
                <!-- <mat-error *ngIf="userForm.get('newPassword').hasError('required')">New password is required </mat-error> -->
                <mat-error *ngIf="userForm.get('newPassword').hasError('minlength')">Password too short!! Password should
                  have a minimum of 8 characters.</mat-error>
                <mat-error
                  *ngIf="userForm.get('newPassword').hasError('pattern') && userForm.get('newPassword').value.length > 7">
                  Make your password strong use(A-Z,a-z,0-9,(*@!?/)</mat-error>
              </mat-form-field>
            </div>

            <div fxLayout="row" fxLayoutAlign="start center" fxLayout.xs="column" fxLayoutWrap fxLayoutGap="0.5%"
              *ngIf="showForAddEditUser === false && userId === 0" style="margin-top: 12px;">
              <mat-form-field appearance="outline" fxFlex="33%" style="width: 232px;">
                <mat-label>Valid From</mat-label>
                <input matInput [matDatepicker]="picker1" name="validFrom" formControlName="validFrom"
                  [readonly]="viewMode" />
                <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                <mat-datepicker #picker1></mat-datepicker>
              </mat-form-field>

              <mat-form-field appearance="outline" fxFlex="34%" style="width: 232px;">
                <mat-label>Valid To</mat-label>
                <input matInput [matDatepicker]="picker4" name="validTo" formControlName="validTo"
                  [readonly]="viewMode" />
                <mat-datepicker-toggle matSuffix [for]="picker4"></mat-datepicker-toggle>
                <mat-datepicker #picker4></mat-datepicker>
              </mat-form-field>

              <mat-form-field appearance="outline" fxFlex="33" style="width: 232px;">
                <mat-label>Password </mat-label>
                <input matInput type="password" [type]="hide2 ? 'password' : 'text'" formControlName="password"
                  pattern="((?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$%^&*?/]).{8,15})" required />
                <mat-icon matSuffix class="secondary-text1" (click)="hide2 = !hide2">
                  {{ hide2 ? "visibility_off" : "visibility" }}</mat-icon>
                <!-- <mat-error *ngIf="userForm.get('newPassword').hasError('required')">
                  Password is required
                </mat-error> -->
                <mat-error *ngIf="userForm.get('password').hasError('minlength')">
                  Password too short!! Password should have a minimum of 8 characters.
                </mat-error>
                <mat-error *ngIf="userForm.get('password').hasError('pattern') && userForm.get('password').value.length > 7">
                  Make your password strong use(A-Z,a-z,0-9,(*@!?/)
                </mat-error>
              </mat-form-field>
            </div>

            <div fxLayout="row" fxLayoutAlign="start center" fxLayout.xs="column" fxLayoutWrap fxLayoutGap="0.5%"
              style="margin-top: 12px;" *ngIf="showForMyProfile === true && enableEdit">
              <!-- <div fxFlex="23%" class="pr-4" appearance="outline">
                <section class="tp-section">
                  <label class="example-margin">Account Status:</label>&nbsp;
                  <div style="margin-top: 8px;">
                    <input type="radio" value="activated" [checked]="true" name="status" /> Activated &nbsp;
                    <input type="radio" value="locked" name="status" /> Locked
                  </div>
                </section>
              </div> -->
              <div fxFlex="33%" class="pr-4" appearance="outline" style="margin-top: 17px;">
                <mat-checkbox (change)="changePassword($event.checked)" (click)="onValueChange()"
                  formControlName="check">Change Password</mat-checkbox>
              </div>
              <mat-form-field appearance="outline" fxFlex="34%" class="pr-4" *ngIf="showPasswordsection">
                <mat-label>Current Password</mat-label>
                <input matInput type="password" [type]="hide ? 'password' : 'text'" formControlName="password"
                  required />
                <mat-icon matSuffix class="secondary-text1" (click)="hide = !hide">
                  {{ hide ? "visibility_off" : "visibility" }}</mat-icon>
                <!-- <mat-error>
                  Password is required
                </mat-error> -->
              </mat-form-field>

              <mat-form-field appearance="outline" fxFlex="33%" *ngIf="showPasswordsection">
                <mat-label>New Password</mat-label>
                <input matInput type="Password" [type]="hide1 ? 'password' : 'text'" formControlName="newPassword"
                  pattern="((?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$%^&*?/]).{8,15})" required />
                <mat-icon matSuffix class="secondary-text1" (click)="hide1 = !hide1">
                  {{ hide1 ? "visibility_off" : "visibility" }}</mat-icon>
                <!-- <mat-error *ngIf="userForm.get('newPassword').hasError('required')">New password is required </mat-error> -->
                <mat-error *ngIf="userForm.get('newPassword').hasError('minlength')">Password too short!! Password should
                  have a minimum of 8 characters.</mat-error>
                <mat-error
                  *ngIf="userForm.get('newPassword').hasError('pattern') && userForm.get('newPassword').value.length > 7">
                  Make your password strong use(A-Z,a-z,0-9,(*@!?/)</mat-error>
              </mat-form-field>
            </div>
            <div></div>
            <!-- <div fxLayout="row" fxLayoutAlign="start center" fxFlex="1 0 auto" style="margin-top: 20px;" style="float:left;"> -->
            <p style="text-align: right; margin-top: 44px;">Last Login: {{ lastLogin }}</p>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>